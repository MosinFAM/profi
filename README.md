## Условие

Cистема учета и анализа данных, поступающих с условного устройства. Полученные данные привязываются к временной метке и устройству, с которого пришли данные, и сохраняются в БД. Набор данных используется для дальнейшего анализа. 

Характеристики системы:

•	В системе реализован сбор статистики с устройства по его идентификатору. Формат получаемой статистики - {“x”: float, “y”: float, “z”:float}

•	В системе реализован анализ собранной статистики с устройства за определенный период и за все время.

•	Результатами анализа являются числовые характеристики величины: минимальное значение, максимальное значение, количество, сумма, медиана.

• Система поддерживает добавление пользователей устройств.

• В системе реализован функционал получения анализа показаний устройств по идентификатору пользователя:
агрегированные результаты для всех устройств и для каждого устройства отдельно

Требования к реализации:

•	Сервис и его окружение разворачивается средствами docker + docker-compose.


## Запуск контейнера

```bash
docker compose -f docker-compose.yml up -d --build  
```

## API

Тестировать API можно с помощью Swagger (http://localhost:8000/docs#) или curl.

Вот некоторые примеры:

1. Создать пользователя

```bash
curl -X POST http://localhost:8000/users \
  -H "Content-Type: application/json" \
  -d '{"name": "user_name"}'
```

2. Добавить устройство

```bash
curl -X POST http://localhost:8000/devices \
  -H "Content-Type: application/json" \
  -d '{"name": "device_name", "user_id": user_id}'
```

3. Добавить статистику

```bash
curl -X POST http://localhost:8000/statistics \
  -H "Content-Type: application/json" \
  -d '{"x": 1.0, "y": 2.0, "z": 3.0, "device_id": device_id}'
```

Получение статистик в асинхронном режиме при помощи Celery:

1. Статистика устройств конкретного пользователя

```bash
curl http://localhost:8000/user/{user_id}/statistics/async
```

2. Статистика конкретного устройства пользователя

```bash
curl http://localhost:8000/user/user_id/device/{device_id}/statistics/async
```

3. Каждая статистика в отдельности

```bash
curl http://localhost:8000/device/{device_id}/statistics/async
```

Проверка статуса задачи:

```bash
curl http://localhost:8000/analytics/status/{task_id}
```